<!DOCTYPE HTML>
<html>
  <head>
    <title>Chomson's United: Andrew and Jenny are getting married!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Andrew and Jenny are getting married!">
    <meta name="author" content="Andrew Thomson">
    <script src="assets/js/jquery-1.7.2.min.js"></script>
    <script>window.jQuery || document.write('<script src="assets/js/jquery-1.7.2.min.js"><\/script>')</script>
    <script src="assets/js/jquery-ui-1.8.22.custom.min.js"></script>
    <script src="assets/js/jquery.imagesloaded.min.js"></script>
    <script src="assets/js/modernizr-2.5.3.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.13"></script>
    <script type="text/javascript" src="http://maps.stamen.com/js/tile.stamen.js?v1.3.0"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,300' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:200' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="assets/css/jquery-ui.css" rel="stylesheet">
    <link href="assets/css/jquery.ui.slider.css" rel="stylesheet">
    <link href="assets/css/main.css" rel="stylesheet">


    <!-- IE Fix for HTML5 Tags -->
    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body onload="initialize_map()">

    <!-- Navbar -->
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand scroller" data-section="html" href="index.html">CHOMSONS UNITED</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right">
              <li><a href="#" class="scroller" data-section="#rsvp_container">RSVP</a></li>
              <li><a href="#" class="scroller" data-section="#map">Map</a></li>
              <li><a href="#" class="scroller" data-section="#team">The Team</a></li>
              <li><a href="#" class="scroller" data-section="#accommodations">Accommodations</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- end Navbar -->

    <!-- #main-container -->
    <div class="main-container">

      <!-- #intro -->
      <div class="container-fluid" id="intro">
        <div class="container">
          <div class="row">
            <div class="span5 offset6">
              <h1>Andrew and Jenny are getting married!</h1>
              <h2>August 8th 2015<br>5:30 pm Gilroy, CA</h2>
            </div>
          </div>
        </div>
      </div>
      <!-- ends Intro -->

      <!-- #rsvp -->
      <div class="container-fluid" id="rsvp_container">
        <div class="container dark">
          <h2>RSVP</h2>
          <div id="success_message" class="row" style="display:none;">
            <div class="span12">
              <h3>Yay! Thank you</h3>
            </div>
          </div>
          <div id="error_message" class="row" style="display:none;">
            <div class="span12">
              <h4>Oh noes!  There was an error - please try again or email us at chomsonsunited@gmail.com</h4>
            </div>
          </div>


          <div id="rsvp_box" class="row">
            <div class="span7 offset3">
              <form id="rsvp_form" name="rsvp" action="https://chomsonforms.s3.amazonaws.com/" method="post" enctype="multipart/form-data">
                <div class="control-group">
                  <div class="controls">
                    <span class="span1 offset1" id="attending">Attending!!</span><span id="slider" class="span1"></span><span class="span2" id="not_attending">Regretfully Decline</span><br/><br/>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label" for="name1">Name(s)</label>
                  <div class="controls">
                    <input type="text" class="span6 guest_name" id="name1" placeholder="First and Last"></br>
                    <button type="button" id="add_button" class="btn btn-peach" data-num-guests=1>+ Add guest</button>
                  </div>
                </div>
                <div class="control-group">
                  <div class="controls">
                    <textarea id="diet_restrictions" placeholder="Please enter dietary restrictions here." rows="3" class="span6"></textarea>
                  </div>
                </div>
                <div class="control-group">
                  <div class="controls">
                    <button type="button" id="rsvp_button" class="btn btn-blue">Submit</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <!-- End rsvp -->

      <!-- #map -->
      <div class="container-fluid" id="map">
        <div class="container light">
          <h2>Map</h2>
          <div class="span8" id="map_place"></div>
          <div class="span2">
            <h3>Directions</h3>
            <a href="https://www.google.com/maps/dir//3255+Day+Rd,+Gilroy,+CA+95020/@37.0470922,-121.651969,17z/data=!4m13!1m4!3m3!1s0x808e1fb592efe30d:0x1e152417d3749b2e!2s3255+Day+Rd,+Gilroy,+CA+95020!3b1!4m7!1m0!1m5!1m1!1s0x808e1fb592efe30d:0x1e152417d3749b2e!2m2!1d-121.651969!2d37.0470922" target="_blank">Kirigin Cellars<br>3255 Day Road, Gilroy, CA 95020</a>
            <br><br>
            (408) 847-8827
          </div>
        </div>
      </div>
      <!-- ends map-->

      <!-- #team -->
      <div class="container-fluid" id="team">
        <div class="container dark">
          <h2>Meet the team</h2>
          <ul class="thumbnails">

            <li class="span4">
              <div class="thumbnail">
                <img alt="" src="assets/img/andrew_yellow.jpg">
                <h3>Andrew</h3>
                <p>The Hacker</p>
              </div>
            </li>

            <li class="span4">
              <div class="thumbnail">
                <img alt="" src="assets/img/ramen_cool.jpg">
                <h3>Ramen</h3>
                <p>The Mastermind</p>
              </div>
            </li>

            <li class="span4">
              <div class="thumbnail">
                <img alt="" src="assets/img/jenny_yellow.jpg">
                <h3>Jenny</h3>
                <p>The Muscle</p>
              </div>
            </li>
          </ul>
          <div class=photoshoot><h3><a href="https://www.facebook.com/media/set/?set=a.10103701381623383.1073741834.3226574&type=3">See the engagement photo shoot!</a></h3></div>
          <h2>The Groomsmen</h2>
          <ul class="thumbnails">
            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/mark4.jpg">
                <h3>Mark</h3>
                <p>The Fixer</p>
              </div>
            </li>

            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/laine1.jpg">
                <h3>Laine</h3>
                <p>The Gadget Guy</p>
              </div>
            </li>

            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/jrod2.jpg">
                <h3>Jared</h3>
                <p>The Inside Man</p>
              </div>
            </li>

            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/dan1.jpg">
                <h3>Dan</h3>
                <p>The Backer</p>
              </div>
            </li>
          </ul>
          <h2>The Bridesmaids</h2>
          <ul class="thumbnails">
            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/tiff2.jpg">
                <h3>Tiffany</h3>
                <p>The Legendary Thief</p>
              </div>
            </li>

            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/wenwen4.jpg">
                <h3>Wen Wen</h3>
                <p>The Distraction</p>
              </div>
            </li>

            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/yoyo2.jpg">
                <h3>Yoo-Yoo</h3>
                <p>The New Kid</p>
              </div>
            </li>

            <li class="span3">
              <div class="thumbnail">
                <img alt="" src="assets/img/lois1.jpg">
                <h3>Lois</h3>
                <p>The Mission Control</p>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <!-- End Team -->


      <!-- #accommodations -->
      <div class="container-fluid" id="accommodations">
        <div class="container light">
          <h2>Accommodations</h2>
          <p class="center-text">For your convenience, we have reserved room blocks at the Best Western in Gilroy and the Four Points in San Jose for August 7 and 8th.</p>
          <div class="row">
            <h3>Best Western Plus Forest Park Inn (Gilroy)</h3>
            <div class="span4"><img alt="" src="assets/img/best_western.jpg"></div>
            <div class="span8">
              <ul>
                <li>$144/night - 1 King</li>
                <li>$144/night - 2 Queen</li>
              </ul>
              To make a reservation, call (408) 848-5144 and let them know that this is for the Chen/Thomson wedding. Reservations must be placed on or before July 7, 2015.<br/><br/>
              <a href="https://www.google.com/maps/dir/3255+Day+Rd,+Gilroy,+CA+95020/375+Leavesley+Rd,+Gilroy,+CA+95020/@37.0388121,-121.6465976,13z/data=!3m1!4b1!4m13!4m12!1m5!1m1!1s0x808e1fb592efe30d:0x1e152417d3749b2e!2m2!1d-121.651969!2d37.0470922!1m5!1m1!1s0x8091e3da7d619147:0x85409acd064594b6!2m2!1d-121.570644!2d37.021671" target="_blank">Best Western Plus Forest Park<br>375 Leavesley Road, Gilroy, CA 95020</a>
            </div>
          </div>
          <div class="row">
            <h3>Four Points by Sheraton Silicon Valley (San Jose)</h3>
            <div class="span4"><img alt="" src="assets/img/four_points.jpg"></div>
            <div class="span8">
              <ul>
                <li>$105/night - 1 King</li>
                <li>$115/night - 2 Queen</li>
                <li>$145/night - Suite, 1 King</li>
              </ul>
              To make a reservation, call (408) 972-7800 and let them know that this is for the Chen/Thomson wedding. Reservations must be placed on or before August 3, 2015.<br/><br/>
              <a href="https://www.google.com/maps/dir/3255+Day+Rd,+Gilroy,+CA+95020/399+Silicon+Valley+Blvd,+San+Jose,+CA+95138/@37.1471731,-121.8468752,11z/data=!3m1!4b1!4m13!4m12!1m5!1m1!1s0x808e1fb592efe30d:0x1e152417d3749b2e!2m2!1d-121.651969!2d37.0470922!1m5!1m1!1s0x808e2e5060e34b8b:0xe7d35c1055e7e47c!2m2!1d-121.7738009!2d37.2476043" target="_blank">Four Points by Sheraton Silicon Valley<br>399 Silicon Valley Blvd, San Jose, CA 95138</a>
            </div>
          </div>
        </div>
      </div>
      <!-- End Accommodations -->

    </div> <!-- end main-container -->

    <script>
      $(function () {
        $(window).scroll(function(){
          // global scroll to top button
          if ($(this).scrollTop() > 300) {
            $('.scrolltop').fadeIn();
          } else {
            $('.scrolltop').fadeOut();
          }
        });

        // scroll nav
        $('.scroller').click(function(){
          var section = $($(this).data("section"));
          var top = section.offset().top-82;
          $("html, body").animate({ scrollTop: top }, 700);
          return false;
        });
      });
    </script>
    <script type="text/javascript">
      function uuid() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
          var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
          return v.toString(16);
        });
      }

      function initialize_map() {
        var options = {
          center: new google.maps.LatLng(37.046447,-121.652471),
          zoom: 12,
          mapTypeId: "watercolor",
          mapTypeControlOptions: {
            mapTypeIds: ["watercolor", google.maps.MapTypeId.ROADMAP,]
          },
          panControl: false,
          zoomControl: false,
          mapTypeControl: true,
          scaleControl: false,
          streetViewControl: false,
          overviewMapControl: false,
          scrollwheel: false,
        };
        var map = new google.maps.Map(document.getElementById("map_place"), options);
        var address = "Kirigin Cellars, 3255 Day Road, Gilroy, CA";
        var geocoder = new google.maps.Geocoder();
        geocoder.geocode( { 'address': address}, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            map.setCenter(results[0].geometry.location);
            var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location
            });
          } else {
            alert('Geocode was not successful for the following reason: ' + status);
          }
        });

        map.mapTypes.set("watercolor", new google.maps.StamenMapType("watercolor"));
      }

      function loadRemoveButton() {
        $('.remove_button').on('click', function (e) {
          e.preventDefault();
          row = "#" + $(this).data('row-id')
          $(row).remove();
        });
      }

      $(document).ready(function() {
        $('#attending').addClass('slider_selected');
        $('#not_attending').addClass('slider_notselected');
        $('#slider').slider({
          max: 1,
          min: 0,
          change: function(event, ui) {
            value = $(this).slider("value");
            if(value == "0") {
              $('#attending').addClass('slider_selected').removeClass('slider_notselected');
              $('#not_attending').removeClass('slider_selected').addClass('slider_notselected');
            } else {
              $('#attending').removeClass('slider_selected').addClass('slider_notselected');
              $('#not_attending').addClass('slider_selected').removeClass('slider_notselected');
            }
          }
        });
        $('#attending').on('click', function () {
          $('#slider').slider("value", 0);
        });
        $('#not_attending').on('click', function () {
          $('#slider').slider("value", 1);
        });

        $('#rsvp_button').on('click', function (e) {
          e.preventDefault();
          $('#error_message').hide("blind");

          var doc = {};

          slider_value = $('#slider').slider('value')
          if (slider_value == 0) {
            doc['attending'] = 'true';
          } else {
            doc['attending'] = 'false';
          }

          doc['names'] = []

          $('.guest_name').each(function () {
            id = $(this).attr('id');
            doc['names'].push($('#' + id).val());
          });

          doc['diet_restrictions'] = $('#diet_restrictions').val();
          doc_str = JSON.stringify(doc)
          doc_key = "rsvp/" + uuid()

          var formData = new FormData();
          formData.append("key", doc_key);
          formData.append("AWSAccessKeyId", "AKIAJ4NGYR7BDC7CHQVA");
          formData.append("acl", "private");
          formData.append("success_action_redirect", "success.html");
          formData.append("policy", "eyJleHBpcmF0aW9uIjogIjIwMTYtMDEtMDFUMDA6MDA6MDBaIiwKICAiY29uZGl0aW9ucyI6IFsKICAgIHsiYnVja2V0IjogImNob21zb25mb3JtcyJ9LAogICAgWyJzdGFydHMtd2l0aCIsICIka2V5IiwgInJzdnAvIl0sCiAgICB7ImFjbCI6ICJwcml2YXRlIn0sCiAgICB7InN1Y2Nlc3NfYWN0aW9uX3JlZGlyZWN0IjogInN1Y2Nlc3MuaHRtbCJ9LAogICAgWyJjb250ZW50LWxlbmd0aC1yYW5nZSIsIDAsIDEwNDg1NzZdCiAgXQp9Cg==");
          formData.append("signature", "AGmvSkZNiH1zSjogqMRDYjr1OBI=");
          formData.append("file", doc_str);

          $.ajax({
            type: "POST",
            contentType: false,
            processData: false,
            mimeType:"multipart/form-data",
            url: $('#rsvp_form').attr('action'),
            data: formData,
            success: function(data) {
              console.log("success");
              $('#rsvp_box').hide("blind");
              $('#success_message').show("blind");
            },
            error: function(jqXHR, textStatus, errorMessage) {
              if (jqXHR.status != 0) {
                console.log("error");
                console.log("status " + textStatus)
                console.log("emssage " + errorMessage);
                console.log("thingy " + jqXHR.status);
                $('#error_message').show("blind");
              } else {
                console.log("success");
                console.log("status " + textStatus)
                console.log("emssage " + errorMessage);
                console.log("thingy " + jqXHR.status);
                $('#rsvp_box').hide("blind");
                $('#success_message').show("blind");
              }
            }
          });
        });

        $('#add_button').on('click', function (e) {
          e.preventDefault();
          num_guests = $(this).data('num-guests') + 1
          new_guest = "<span id='name_row" + num_guests.toString() + "'>" +
          "<input type='text' class='span6 guest_name' id='name" + num_guests.toString() + "' placeholder='First and Last'>" +
          "<button type='button' class='btn btn-peach remove_button' data-row-id='name_row" + num_guests.toString() + "'>-</button><br/></span>"
          $(this).before(new_guest)
          $(this).data('num-guests', num_guests)
          loadRemoveButton();
        });
      });
    </script>
  </body>
</html>
