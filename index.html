<!DOCTYPE HTML>
<html>
<head>
    <title>Chomson's United: Andrew and Jenny are getting married!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Andrew and Jenny are getting married!">
    <meta name="author" content="Andrew Thomson">
    <script src="assets/js//jquery-1.7.2.min.js"></script>
    <script>window.jQuery || document.write('<script src="assets/js/jquery-1.7.2.min.js"><\/script>')</script>
    <script src="assets/js/jquery-ui-1.8.22.custom.min.js"></script>
    <script src="assets/js/jquery.imagesloaded.min.js"></script>
    <script src="assets/js/modernizr-2.5.3.min.js"></script>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyB2_fDpWOUX-_CfICIz9zUdhKjZkCDcVig&sensor=false"></script>
    <script type="text/javascript" src="http://maps.stamen.com/js/tile.stamen.js?v1.3.0"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,300' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:200' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="assets/css/main.css" rel="stylesheet">

  <!-- IE Fix for HTML5 Tags -->
  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>
<body onload="initialize_map()">

  <!-- Navbar -->
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand scroller" data-section="html" href="index.html">CHOMSONS UNITED</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right">
              <li><a href="#" class="scroller" data-section="#map">Map</a></li>
              <li><a href="#" class="scroller" data-section="#team">The Team</a></li>
              <li><a href="#" class="scroller" data-section="#address_container">Save the Date</a></li>
              <li><a href="#" class="scroller" data-section="#rsvp_container">RSVP</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  <!-- end Navbar -->

  <!-- #intro -->
    <div class="main-container">
      <div class="container-fluid" id="intro">
        <div class="container">
          <div class="row span6 center">
            <h1>Andrew and Jenny are getting married!</h1>
            <h2>August 8th 2015<br>6pm Gilroy, CA</h2>
            <a href="#" data-section="#rsvp_container" class="scroller btn btn-xlarge btn-purple">RSVP</a>
          </div>
        </div>
      </div>
  <!-- ends Intro -->


  <!-- #map -->
    <div class="container-fluid" id="map">
      <div class="container light">
        <h1>Map</h1>
        <div class="span8" id="map_place"></div>
        <div class="span2">
          <a href="https://www.google.com/maps/dir/''/kirigin+cellars/@37.0464421,-121.6868038,13z/data=!3m1!4b1!4m8!4m7!1m0!1m5!1m1!1s0x808e1fb5e2aac787:0xa231c87dc88b5869!2m2!1d-121.652471!2d37.046447"><h3>Directions</h3>Kirigin Cellars<br>11550 Watsonville Road, Gilroy, CA 95020</a>
          <br><br>
          (408) 847-8827
        </div>
      </div>
    </div>
  <!-- ends map-->

  <!-- #team -->
    <div class="container-fluid" id="team">
      <div class="container dark">
        <h1>Meet the team</h1>
        <ul class="thumbnails">
          <li class="span4">
            <div class="thumbnail">
              <img alt="" src="assets/img/jenny_yellow.jpg">
              <h3>Jenny</h3>
              <p>The Muscle</p>
            </div>
          </li>

          <li class="span4">
            <div class="thumbnail">
              <img alt="" src="assets/img/ramen_cool.jpg">
              <h3>Ramen</h3>
              <p>The Mastermind</p>
            </div>
          </li>

          <li class="span4">
            <div class="thumbnail">
              <img alt="" src="assets/img/andrew_yellow.jpg">
              <h3>Andrew</h3>
              <p>The Hacker</p>
            </div>
          </li>
        </ul>
      </div>
    </div>
  <!-- End Team -->

  <!-- #address -->
    <div class="container-fluid" id="address_container">
      <div class="container dark">
        <h1>Save the Date</h1>

        <div class="span5">
          <form id="address_form" name="address" action="https://chomsonforms.s3.amazonaws.com/" method="post" enctype="multipart/form-data">
            <input type="hidden" name="key" id="address_key" value="address/test_stuff"> <!-- TODO HACK THIS -->
            <input type="hidden" name="AWSAccessKeyId" value="AKIAJ4NGYR7BDC7CHQVA">
            <input type="hidden" name="acl" value="private">
            <input type="hidden" name="success_action_redirect" value="success.html">
            <input type="hidden" name="policy" value="eyJleHBpcmF0aW9uIjogIjIwMTYtMDEtMDFUMDA6MDA6MDBaIiwKICAiY29uZGl0aW9ucyI6IFsKICAgIHsiYnVja2V0IjogImNob21zb25mb3JtcyJ9LAogICAgWyJzdGFydHMtd2l0aCIsICIka2V5IiwgImFkZHJlc3MvIl0sCiAgICB7ImFjbCI6ICJwcml2YXRlIn0sCiAgICB7InN1Y2Nlc3NfYWN0aW9uX3JlZGlyZWN0IjogInN1Y2Nlc3MuaHRtbCJ9LAogICAgWyJjb250ZW50LWxlbmd0aC1yYW5nZSIsIDAsIDEwNDg1NzZdCiAgXQp9Cg==">
            <input type="hidden" name="signature" value="TbZUpBJHQdeDdcBYzCU8H31/vJU=">
            <input id='address_file' name="file" type="hidden">
            <div class="control-group">
              <label class="control-label" for="Name">Name</label>
              <div class="controls">
                <input type="text" class="span4" id="Name" placeholder="First and Last">
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="Address Line 1">Address</label>
              <div class="controls">
                <input type='text' id="AddressLine1" class="span4" placeholder="Address Line 1">
                <input type='text' id="AddressLine2" class="span4" placeholder="Address Line 2">
                <input type='text' id="City" class="span2" placeholder="City">
                <input type='text' id="State" class="span1" placeholder="State">
                <input type='text' id="Zip" class="span1" placeholder="Zip">
              </div>
            </div>
            <div class="control-group">
              <div class="controls">
                <button type="submit" id="address_button" class="btn btn-purple">Submit</button>
              </div>
            </div>
          </form>
        </div>

        <div class="span6">
          <h2>Mailing Address</h2>

          <p>To help with the invitation addresses, please submit your current mailing address!</p>

        </div>
      </div>
    </div>
  <!-- End address -->

  <!-- #rsvp -->
    <div class="container-fluid" id="rsvp_container">
      <div class="container dark">
        <h1>RSVP</h1>

        <div class="span5">
          <form id="rsvp_form" name="rsvp" action="https://chomsonforms.s3.amazonaws.com/" method="post" enctype="multipart/form-data">
            <input type="hidden" name="key" id="rsvp_key" value="rsvp/test_stuff"> <!-- TODO HACK THIS -->
            <input type="hidden" name="AWSAccessKeyId" value="AKIAJ4NGYR7BDC7CHQVA">
            <input type="hidden" name="acl" value="private">
            <input type="hidden" name="success_action_redirect" value="success.html">
            <input type="hidden" name="policy" value="eyJleHBpcmF0aW9uIjogIjIwMTYtMDEtMDFUMDA6MDA6MDBaIiwKICAiY29uZGl0aW9ucyI6IFsKICAgIHsiYnVja2V0IjogImNob21zb25mb3JtcyJ9LAogICAgWyJzdGFydHMtd2l0aCIsICIka2V5IiwgInJzdnAvIl0sCiAgICB7ImFjbCI6ICJwcml2YXRlIn0sCiAgICB7InN1Y2Nlc3NfYWN0aW9uX3JlZGlyZWN0IjogInN1Y2Nlc3MuaHRtbCJ9LAogICAgWyJjb250ZW50LWxlbmd0aC1yYW5nZSIsIDAsIDEwNDg1NzZdCiAgXQp9Cg==">
            <input type="hidden" name="signature" value="AGmvSkZNiH1zSjogqMRDYjr1OBI=">
            <input id='rsvp_file' name="file" type="hidden">
            <div class="control-group">
              <label class="control-label" for="inputName">Attending</label>
              <div class="controls" >
                <input type="radio" class="span1" name="attending" id="attending_yes" value="yes" checked>I'll be there!
                <br>
                <input type="radio" class="span1" name="attending" id="attending_no" value="no">Oh noes, I can't make it
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="GuestName">Guest Name</label>
              <div class="controls">
                <input type="text" class="span4" id="GuestName" placeholder="First and Last">
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="GuestDietRestrictions">Guest Diet Restrictions</label>
              <div class="controls">
                <textarea id="GuestDietRestrictions" class="span4"></textarea>
              </div>
            </div>

            <div class="control-group">
              <label class="control-label" for="Plus1Name">Plus One Name</label>
              <div class="controls">
                <input type="text" class="span4" id="Plus1Name" placeholder="First and Last">
              </div>
            </div>
            <div class="control-group">
              <label class="control-label" for="Plus1DietRestrictions">Plus One Diet Restrictions</label>
              <div class="controls">
                <textarea id="Plus1DietRestrictions" class="span4"></textarea>
              </div>
            </div>

            <div class="control-group">
              <div class="controls">
                <button type="submit" id="rsvp_button" class="btn btn-purple">RSVP</button>
              </div>
            </div>
          </form>
        </div>

        <div class="span4">
          <h2>Please RSVP</h2>

          <p>We are really excited to have you guys attend our special day. Please Place your name below and let us know who else you will be bringing. Also if you have any specific food alergies we should be aware of, please put them into the dietary restrictions boxes.</p>

        </div>
      </div>
    </div>
  <!-- End rsvp -->
</div> <!-- end main-container -->
<script>
  $(function () {
    $(window).scroll(function(){
      // global scroll to top button
      if ($(this).scrollTop() > 300) {
        $('.scrolltop').fadeIn();
      } else {
        $('.scrolltop').fadeOut();
      }
    });

    // scroll nav
    $('.scroller').click(function(){
      var section = $($(this).data("section"));
      var top = section.offset().top-82;
      $("html, body").animate({ scrollTop: top }, 700);
      return false;
    });
  });
</script>
<script type="text/javascript">
  function uuid() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
      return v.toString(16);
    });
  }

  function initialize_map() {
    var options = {
      center: new google.maps.LatLng(37.046447,-121.652471),
      zoom: 12,
      mapTypeId: "Watercolor",
      mapTypeControlOptions: {
        mapTypeIds: ["Watercolor", google.maps.MapTypeId.ROADMAP,]
      },
      panControl: false,
      zoomControl: false,
      mapTypeControl: true,
      scaleControl: false,
      streetViewControl: false,
      overviewMapControl: false,
      scrollwheel: false,
    };
    var map = new google.maps.Map(document.getElementById("map_place"), options);
    var address = "Kirigin Cellars, Watsonville Road, Gilroy, CA";
    var geocoder = new google.maps.Geocoder();
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert('Geocode was not successful for the following reason: ' + status);
      }
    });
    map.mapTypes.set("Watercolor", new google.maps.StamenMapType("watercolor"));
  }

  $("#rsvp_button").on('click', function (e) {
     //ajax call here
     //stop form submission
     e.preventDefault();
     var doc = {};
     var attending = $('input[name=attending]:checked', '#rsvp_form').val();
     doc['attending'] = attending;
     doc['guestname'] = $('#GuestName').val();
     doc['guestdiet'] = $('#GuestDietRestrictions').val();
     doc['plusname'] = $('#Plus1Name').val();
     doc['plusdiet'] = $('#Plus1DietRestrictions').val();
     $('#rsvp_file').val(JSON.stringify(doc))
     $('#rsvp_key').val("rsvp/" + uuid())
     $('#rsvp_form').submit()
  });

  $("#address_button").on('click', function (e) {
     //ajax call here
     //stop form submission
     e.preventDefault();
     var doc = {};
     var attending = $('input[name=attending]:checked', '#address_form').val();
     doc['name'] = $('#Name').val();
     doc['addressline1'] = $('#AddressLine1').val();
     doc['addressline2'] = $('#AddressLine2').val();
     doc['city'] = $('#City').val();
     doc['state'] = $('#State').val();
     doc['zip'] = $('#Zip').val();
     doc_str = JSON.stringify(doc)
     doc_key = "address/" + uuid()
     $('#address_file').val(doc_str)
     $('#address_key').val(doc_key)
     $('#address_form').submit()
     console.log(doc_key + " -> " + doc_str)
  });

</script>
</body>
</html>
